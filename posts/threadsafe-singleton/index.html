<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Is your Singleton Thread-Safe?" /><meta name="author" content="Zeeshan Khan" /><meta property="og:locale" content="en" /><meta name="description" content="First, lets have a look into the concepts of some Terminologies:" /><meta property="og:description" content="First, lets have a look into the concepts of some Terminologies:" /><link rel="canonical" href="https://zeeshankhan.github.io/posts/threadsafe-singleton/" /><meta property="og:url" content="https://zeeshankhan.github.io/posts/threadsafe-singleton/" /><meta property="og:site_name" content="zeeshan’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2014-08-31T00:00:00+04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Is your Singleton Thread-Safe?" /><meta name="twitter:site" content="@zeeshan_khan" /><meta name="twitter:creator" content="@Zeeshan Khan" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zeeshan Khan"},"dateModified":"2014-08-31T00:00:00+04:00","datePublished":"2014-08-31T00:00:00+04:00","description":"First, lets have a look into the concepts of some Terminologies:","headline":"Is your Singleton Thread-Safe?","mainEntityOfPage":{"@type":"WebPage","@id":"https://zeeshankhan.github.io/posts/threadsafe-singleton/"},"url":"https://zeeshankhan.github.io/posts/threadsafe-singleton/"}</script><title>Is your Singleton Thread-Safe? | zeeshan's blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="zeeshan's blog"><meta name="application-name" content="zeeshan's blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/sample/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">zeeshan's blog</a></div><div class="site-subtitle font-italic">Recording my learnings from  development</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/resume/" class="nav-link"> <i class="fa-fw fas fa-file ml-xl-3 mr-xl-3 unloaded"></i> <span>RESUME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/zeeshankhan" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/zeeshan_khan" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['izeeshankhan','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Is your Singleton Thread-Safe?</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Is your Singleton Thread-Safe?</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/zeeshan_khan">Zeeshan Khan</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1409428800" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2014-08-31 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1030 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><h5 id="first-lets-have-a-look-into-the-concepts-of-someterminologies"><span class="mr-2">First, lets have a look into the concepts of some <strong>T</strong><strong>erminologies:</strong></span><a href="#first-lets-have-a-look-into-the-concepts-of-someterminologies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><h3 id="singleton"><span class="mr-2"><strong>Singleton</strong></span><a href="#singleton" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>A singleton class returns the same instance no matter how many times an application requests it. A typical class permits callers to create as many instances of the class as they want, whereas with a singleton class, there can be only one instance of the class per process. A singleton object provides a global point of access to the resources of its class. Singletons are used in situations where this single point of control is desirable, such as with classes that offer some general service or resource.</p><h3 id="thread-safe"><span class="mr-2"><strong>Thread-Safe</strong></span><a href="#thread-safe" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Thread safe code can be safely called from multiple threads or concurrent tasks without causing any problems (data corruption, crashing, etc). Code that is not thread safe must only be run in one context at a time. An example of thread safe code is NSArray. You can use it from multiple threads at the same time without issue. On the other hand, NSMutableArray is not thread safe and should only be accessed from one thread at a time.</p><h3 id="context-switch"><span class="mr-2"><strong>Context Switch</strong></span><a href="#context-switch" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>A context switch is the process of storing and restoring execution state (context) of a process or thread, when we switch between executing different threads on a single core (single process). So that the execution can be resumed from the same point at a later time. This enables multiple processes to share a single CPU and is an essential feature of a multitasking operating system. It’s like switching from one thread (process) to another.</p><h2 id="creating-thread-safe-singletons"><span class="mr-2"><strong>Creating Thread-Safe Singletons</strong></span><a href="#creating-thread-safe-singletons" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Singletons, A very popular design pattern in every technology. One frequent concern with singletons is that often they’re not thread safe. This concern is well-justified given their use: singletons are often used from multiple controllers accessing the singleton instance at the same time.</p><p>Lets take an example, we have a class <strong>DocumentManager</strong>, which manages all our document read, write handling. And the <strong>DocumentManager</strong> class has been implemented as a singleton. To see how things can go wrong really quickly, we’ll create a controlled race condition on the singleton instance.</p><p>The current sharedManager function looks like the code below:</p><ul><li>(instancetype)sharedManager   {     static DocumentManager * sharedDocumentManager = nil;     if (!sharedDocumentManager) {         sharedDocumentManager = [[DocumentManager alloc] init];         NSLog(@”Singleton has memory address at: %@”, sharedDocumentManager);     }     return sharedDocumentManager; }</ul><p>The code is rather simple in its current state; we create a singleton. However, the if condition branch is not thread safe; if we invoke this method multiple times, there’s a possibility that one thread (call it Thread-A) could enter the if block and a context switch could occur before sharedDocumentManager is allocated. Then another thread (Thread-B) could enter the if, allocate an instance of the singleton, then exit.</p><p>When the system context switches back to Thread-A, we’ll then allocate another instance of the singleton, then exit. At that point we have two instances of a singleton — which is not what we want!</p><p>To force this condition to happen, replace <strong>sharedManager</strong> function in <strong>DocumentManager.m</strong> with the following implementation:</p><ul><li>(instancetype)sharedManager   {     static DocumentManager * sharedDocumentManager = nil;     if (!sharedDocumentManager) {         [NSThread sleepForTimeInterval:2];         sharedDocumentManager = [[DocumentManager alloc] init];         NSLog(@”Singleton memory address: %@”, sharedDocumentManager);         [NSThread sleepForTimeInterval:2];     }     return sharedDocumentManager; }</ul><p>In the code above we’re forcing a context switch to happen with <strong>NSThread’s sleepForTimeInterval:</strong> class method.</p><p>Now make a call to <strong>sharedManager</strong> function, for doing the same, Open <strong>AppDelegate.m</strong> and add the following code to the very beginning of <strong>application:didFinishLaunchingWithOptions:</strong></p><p>dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^{         [DocumentManager sharedManager]; });     dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^{         [DocumentManager sharedManager]; });</p><p>This creates multiple asynchronous concurrent calls to instantiate the singleton and invoke the race condition as described above.</p><p>Build and run our project; check the console output and we’ll see multiple singletons instantiated, as shown below:</p><p>[caption id=”attachment_165” align=”aligncenter” width=”772”]<a href="https://izeeshan.files.wordpress.com/2014/08/threadsafesingleton1.png"><img data-src="images/threadsafesingleton1.png" alt="A console output demonstrating Thread-Unsafe Singleton object address." data-proofer-ignore></a> Console Output: Thread-Unsafe Singleton object address.[/caption]</p><p>Notice that there are several lines all showing different addresses of the singleton instance. That defeats the purpose of a singleton, doesn’t it? :)</p><p>This output shows we that the critical section executed several times when it should have only have executed once. Now, admittedly, we forced this situation to happen, but we can imagine how this condition could occur unintentionally as well.</p><h5 id="note-based-upon-other-system-events-beyond-our-control-a-variable-amount-of-nslogs-will-show-up-on-occasion-threading-issues-can-be-extremely-hard-to-debug-since-they-tend-to-be-hard-to-reproduce"><span class="mr-2"><strong>Note</strong>: Based upon other system events beyond our control, a variable amount of <strong>NSLogs</strong> will show up on occasion. Threading issues can be extremely hard to debug since they tend to be hard to reproduce.</span><a href="#note-based-upon-other-system-events-beyond-our-control-a-variable-amount-of-nslogs-will-show-up-on-occasion-threading-issues-can-be-extremely-hard-to-debug-since-they-tend-to-be-hard-to-reproduce" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><p>To correct this condition, the instantiation code should only execute once and block other instances from running while it is in the critical section of the <strong>if</strong> condition. This is exactly what <strong>dispatch_once</strong> does.</p><p>Replace the conditional <strong>if</strong> check with <strong>dispatch_once</strong> in the singleton initialisation method as shown below:</p><p>+ (instancetype)sharedManager   {     static DocumentManager * sharedDocumentManager = nil;     static dispatch_once_t onceToken;     dispatch_once(&amp;onceToken, ^{</p><p>        [NSThread sleepForTimeInterval:2];         sharedDocumentManager = [[DocumentManager alloc] init];         NSLog(@”Singleton memory address: %@”, sharedDocumentManager);         [NSThread sleepForTimeInterval:2];     });     return sharedDocumentManager; }</p><p>Build and run our app; check the console output and we’ll now see one and only one instantiation of the singleton — which is what we’d expect for a singleton! :)</p><p>Now that we understand the importance of preventing race conditions, replace <strong>DocumentManager’s</strong> singleton initialisation with the following implementation:</p><p>+ (instancetype)sharedManager   {     static DocumentManager * sharedDocumentManager = nil;     static dispatch_once_t onceToken;     dispatch_once(&amp;onceToken, ^{         sharedDocumentManager = [[DocumentManager alloc] init];         NSLog(@”Singleton memory address: %@”, sharedDocumentManager);     });     return sharedDocumentManager; }</p><p><strong>dispatch_once()</strong> executes a block once and only once in a thread safe manner. Different threads that try to access the critical section — the code passed to <strong>dispatch_once</strong> — while a thread is already in this section are blocked until the critical section completes.</p><p><a href="https://izeeshan.files.wordpress.com/2014/08/there-can-only-be-one.jpg"><img data-src="https://izeeshan.files.wordpress.com/2014/08/there-can-only-be-one.jpg?w=286" alt="there-can-only-be-one" data-proofer-ignore></a></p><p>It should be noted that this just makes access to the shared instance thread safe. It does not make the class thread safe, necessarily. We could still have other critical sections in the class, for instance anything that manipulates internal data. Those would need to be made thread safe in other ways, such as synchronising access to the data.</p><h5 id="thanks-for-reading-"><span class="mr-2">Thanks for reading. :)</span><a href="#thanks-for-reading-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><p>Some parts of this post is derived from <a href="http://www.raywenderlich.com/60749/grand-central-dispatch-in-depth-part-1" title="Ray Wenderlich Tutorials">Ray Wenderlich Tutorials</a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/technical-posts/'>technical-posts</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ios/" class="post-tag no-text-decoration" >ios</a> <a href="/tags/multithreading/" class="post-tag no-text-decoration" >multithreading</a> <a href="/tags/threads/" class="post-tag no-text-decoration" >threads</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Is your Singleton Thread-Safe? - zeeshan&#39;s blog&amp;url=https://zeeshankhan.github.io/posts/threadsafe-singleton/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Is your Singleton Thread-Safe? - zeeshan&#39;s blog&amp;u=https://zeeshankhan.github.io/posts/threadsafe-singleton/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://zeeshankhan.github.io/posts/threadsafe-singleton/&amp;text=Is your Singleton Thread-Safe? - zeeshan&#39;s blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/view/">iOS View</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ios/">ios</a> <a class="post-tag" href="/tags/swift/">swift</a> <a class="post-tag" href="/tags/objective-c/">objective-c</a> <a class="post-tag" href="/tags/multithreading/">multithreading</a> <a class="post-tag" href="/tags/threads/">threads</a> <a class="post-tag" href="/tags/blocks/">blocks</a> <a class="post-tag" href="/tags/gcd/">gcd</a> <a class="post-tag" href="/tags/ipad/">ipad</a> <a class="post-tag" href="/tags/nsthread/">nsthread</a> <a class="post-tag" href="/tags/view-controllers/">view-controllers</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/dispatch-barriers/"><div class="card-body"> <em class="timeago small" data-ts="1409688000" > 2014-09-03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Handling Shared Resources using Dispatch Barriers</h3><div class="text-muted small"><p> Handling Thread-Unsafe Shared Resource In the last post, we have discussed about creating thread-safe singleton objects. But creating a thread-safe singleton does not solve all the issues. If your...</p></div></div></a></div><div class="card"> <a href="/posts/multi-threading-using-nsoperation/"><div class="card-body"> <em class="timeago small" data-ts="1408219200" > 2014-08-17 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Multi-Threading using NSOperation</h3><div class="text-muted small"><p> Recently I had given couple of presentations on Multithreading using NSOperations and GCD. Here is the first draft of transcript. CPU (Central Processing Unit) WHY I’m starting from here, because...</p></div></div></a></div><div class="card"> <a href="/posts/thread-safe-vs-thread-un-safe/"><div class="card-body"> <em class="timeago small" data-ts="1408305600" > 2014-08-18 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Thread Safe vs Thread Un-Safe</h3><div class="text-muted small"><p> Thread safe and Thread un-safe objects: Thread safe objects are safe to pass from one thread to another. On the other hand you may get stale value if you try to access a thread unsafe object wi...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/local-http-server-for-ios/" class="btn btn-outline-primary" prompt="Older"><p>Local HTTP Server for iOS</p></a> <a href="/posts/dispatch-barriers/" class="btn btn-outline-primary" prompt="Newer"><p>Handling Shared Resources using Dispatch Barriers</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/zeeshan_khan">Zeeshan Khan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ios/">ios</a> <a class="post-tag" href="/tags/swift/">swift</a> <a class="post-tag" href="/tags/objective-c/">objective-c</a> <a class="post-tag" href="/tags/multithreading/">multithreading</a> <a class="post-tag" href="/tags/threads/">threads</a> <a class="post-tag" href="/tags/blocks/">blocks</a> <a class="post-tag" href="/tags/gcd/">gcd</a> <a class="post-tag" href="/tags/ipad/">ipad</a> <a class="post-tag" href="/tags/nsthread/">nsthread</a> <a class="post-tag" href="/tags/view-controllers/">view-controllers</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
